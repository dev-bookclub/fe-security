# 라이브러리를 노린 보안 리스크

## 라이브러리 사용

### 오픈소스 소프트웨어 사용
- 많은 라이브러리, 프레임워크, 툴 등이 오픈소스 소프트웨어(OSS)로 개발
- 코드가 모두에게 공개되고 원활하게 유지보수되지 않는 경우도 많음

### 프론트엔드 라이브러리 상황
- 프론트엔드에 사용되는 많은 라이브러리가 OSS로 개발됐으며 CDN, npmjs.com을 통해 배포

#### CDN을 통해 배포되는 라이브러리
- CDN에서 바로 전송 혹은 브라우저에서 HTML, JS를 이용해 직접 CDN 리소스를 가져올 수 있음
```html
<script crossorigin src="https://cdn.example.com/dompurify/purify.min.js"></script>
```

## 라이브러리에 숨어있는 보안 리스크

### 서드파티 라이브러리를 경유하는 공격
- 직접 공격하는 게 아닌 서드파티가 작성한 라이브러리 등을 통한 간접적인 공격이 증가
- 오픈소스 라이브러리에 악성 코드를 주입하면 공격 가능

### 리뷰가 충분하지 않은 코드에 의한 취약성
- 코드 리뷰가 충분하지 않은 상태에서 merge하여 악성코드가 포함될 수 있음.

### 계정 탈취에 의한 취약성
- 라이브러리 개발자와 유지보수하는 계정이 탈취되어 악성코드가 포함될 수 있음.

### 의존 관계 상속에 의한 취약성
- 라이브러리가 또 다른 라이브러리를 의존할 수 있기 때문에 의존 관계에 의해 악성코드가 포함될 수 있음.

### CDN에서 콘텐츠 변조
- CDN의 라이브러리가 변조 시 라이브러릴 사용하는 브라저에서 악성코드 실행 가능 

### CDN에서 취약성을 갖는 버전의 라이브러리 가져오기
- CDN 사용 시 CSP를 통해 신뢰할 수 있는 CDN만을 가져올 수 있도록 설정 가능
```text
Content-Security-Policy: script-src https://cdn.example.com
```
- 취약성이 있는 버전을 명시적으로 사용하지 않아도 취약성이 있는 버전 배포중일 시 우회 가능

## 라이브러리 사용의 보안 대책

### 취약성을 확인하는 툴과 서비스 사용

#### 커맨드로 취약성 검사
- `npm audit`이라는 커맨드를 통해 취약점이 포함된 버전의 포함 여부 확인
- `npm audit fix`라는 커맨드를 통해 취약점이 포함된 버전의 자동 업데이트 가능

#### 정기적으로 취약성 확인
- Dependabot 등을 통해 레포지터리에서 사용하는 라이브러리에 알려진 취약점이 있는지 정기적으로 확인

### 유지보수가 꾸준한 라이브러리 사용
- 라이브러리의 최종 커밋 날짜와 이슈 대응 상태 등을 통해 유지보수의 지속성 확인

### 최신 버전 라이브러리 사용
- Renovate 등과 같은 서비스를 통해 사용중인 라이브러리의 새로운 버전 업데이트를 확인

### 하위 지원 무결성을 통한 변조 확인
- 브라우저는 서버에서 가져온 리소스에 변조가 없는지 확인하는 하위 지원 무결성(subresource integrity) 기능을 제공

### CDN에서 불러오는 라이브러리 버전 저장
- 고정된 버전의 라이브러리를 불러와 이전 라이브러리를 불러오는 것을 방지
